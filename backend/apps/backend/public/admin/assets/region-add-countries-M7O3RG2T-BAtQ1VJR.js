import{u as k,a as T,b as E}from"./chunk-NOAFLTPV-CuHG4hnw.js";import{u as I,_ as A}from"./chunk-B2JT2FOA-Cbe-dvAK.js";import{ac as F,eG as z,j as o,b as B,r as g,aw as D,ax as H,aq as M,dg as N,eI as q,t as y,B as S,aB as G,as as K,f as L,Z as b}from"./index-DWDHrirZ.js";import"./chunk-GJUPECDU-BYgcQfoi.js";import{K as O}from"./chunk-6HTZNHPT-BN1Yanla.js";import{R as i,u as V}from"./chunk-4TC5YS65-oIm_9E30.js";import"./chunk-C76H5USB-NCOnWWho.js";import"./chunk-YEDAFXMB-D3NQ1V8j.js";import"./chunk-M3VFKDXJ-Cfhvqd45.js";import"./chunk-AOFGTNG6-C8nbIVVz.js";import"./chunk-EMIHDNB7-B9umjuAU.js";import"./chunk-PFKKVLZX-DzM2ADPA.js";var Z=M({countries:G(K()).min(1)}),m=50,p="ac",Q=({region:t})=>{const{t:e}=B(),{handleSuccess:r}=V(),[a,l]=g.useState({}),u=D({defaultValues:{countries:[]},resolver:H(Z)}),{setValue:h}=u;g.useEffect(()=>{const s=Object.keys(a).filter(n=>a[n]);h("countries",s,{shouldDirty:!0,shouldTouch:!0})},[a,h]);const{searchParams:j,raw:C}=k({pageSize:m,prefix:p}),{countries:_,count:f}=T({countries:N.map((s,n)=>({display_name:s.display_name,name:s.name,id:n,iso_2:s.iso_2,iso_3:s.iso_3,num_code:s.num_code,region_id:null,region:{}})),...j}),x=X(),{table:R}=I({data:_||[],columns:x,count:f,enablePagination:!0,enableRowSelection:s=>{var n;return((n=t.countries)==null?void 0:n.findIndex(c=>c.iso_2===s.original.iso_2))===-1},getRowId:s=>s.iso_2,pageSize:m,rowSelection:{state:a,updater:l},prefix:p}),{mutateAsync:v,isPending:w}=q(t.id),P=u.handleSubmit(async s=>{var c;const n=[...((c=t.countries)==null?void 0:c.map(d=>d.iso_2))??[],...s.countries];await v({countries:n},{onSuccess:()=>{y.success(e("regions.toast.countries")),r()},onError:d=>{y.error(d.message)}})});return o.jsx(i.Form,{form:u,children:o.jsxs(O,{onSubmit:P,className:"flex h-full flex-col overflow-hidden",children:[o.jsx(i.Header,{children:o.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[o.jsx(i.Close,{asChild:!0,children:o.jsx(S,{size:"small",variant:"secondary",children:e("actions.cancel")})}),o.jsx(S,{size:"small",isLoading:w,type:"submit",children:e("actions.add")})]})}),o.jsx(i.Body,{className:"overflow-hidden",children:o.jsx(A,{table:R,columns:x,pageSize:m,count:f,search:"autofocus",pagination:!0,layout:"fill",orderBy:[{key:"display_name",label:e("fields.name")},{key:"iso_2",label:e("fields.code")}],queryObject:C,prefix:p})})]})})},U=L(),X=()=>{const t=E();return g.useMemo(()=>[U.display({id:"select",header:({table:e})=>o.jsx(b,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:r=>e.toggleAllPageRowsSelected(!!r)}),cell:({row:e})=>{const r=!e.getCanSelect();return o.jsx(b,{checked:e.getIsSelected()||r,disabled:r,onCheckedChange:a=>e.toggleSelected(!!a),onClick:a=>{a.stopPropagation()}})}}),...t],[t])},ce=()=>{const{id:t}=F(),{region:e,isPending:r,isError:a,error:l}=z(t,{fields:"*payment_providers"});if(a)throw l;return o.jsx(i,{children:!r&&e&&o.jsx(Q,{region:e})})};export{ce as Component};
